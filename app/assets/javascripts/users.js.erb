//*-- Users Profile Javascript --*/
//= require ios7_switches
//= require loading


/*-- Inline Edit --*/
	$.fn.editable.defaults.mode = 'inline';
	$.fn.editable.defaults.ajaxOptions = {type: "PUT"};
		
	$('#description').editable({
			autotext: true,
			type: 'textarea',
			unsavedclass: null,
			emptytext: 'Please add a description!!',
			emptyclass: null,
			url: '/profile/11',
			success: function(response, newValue) {
				console.log('success')
			}
	});	
	$('#edit_description').on('click', function(e) {
		e.stopPropagation();
        e.preventDefault();
		$('#description').editable('toggle');
	});

	
/*-- Create Broadcast Ajax --*/
	$(document).on('ajax:beforeSend', '#broadcast', function(){
		$('#broadcast').loading();
	}).on('ajax:complete', '#broadcast', function(evt, data, status, xhr){
		$('#new_broadcast .body').html(data.responseText);
	});

/*-- Public Checkbox --*/

	if ($('#upload_public').length > 0) { 

		$('#upload_public').ios_switch( $('#upload_public') );	
		$('#upload_public').on('change', function(e) {
		
			//Full Loading
			$('.full_loading').fadeIn();
		
			$.ajax({
				type: 'PATCH',
				url: $(this).parent().prop('action'),
				data: $(this).serialize( { checkboxesAsBools: true }),
				success: function(data){
				  $('.full_loading').fadeOut();
				},
				error: function(data) {
					$('.full_loading').fadeOut();
					console.log(data);
				}
			});
			
		});	
		
	};


/*-- File Uploaders (Avatar & Portfolio) --*/
	$('#fileupload').fileupload({
		add: function (e, data) {
			var jqXHR = data.submit()
			.success(function (result, textStatus, jqXHR) { location.reload(); })
			.error(function (jqXHR, textStatus, errorThrown) {/* ... */})
			.complete(function (result, textStatus, jqXHR) {/* ... */});
		}
		
	});
	$('#avatar').fileupload({
		add: function (e, data) {
			var jqXHR = data.submit()
			.success(function (result, textStatus, jqXHR) { location.reload(); })
			.error(function (jqXHR, textStatus, errorThrown) {/* ... */})
			.complete(function (result, textStatus, jqXHR) {/* ... */});
		}
		
	});